# Surplus Inventory Simulator
An Excel dashboard that can be used to simulate the impact of shelf-life extensions and production changes. This was developed with real company data for my employer. I will only provide a high level view of the project to protect my employer's privacy. You can follow along this in this README while looking at the PDF file in this repository.

<h2>Definitions</h2>
<ul>
  <li><b>SKU: </b>A stock keeping unit is a number that is assigned to a product for identification and tracking purposes.</li>
  <li><b>NSV: </b>Net Sales Value is the amount of profit we would generate. Revenue minus Cost of Goods Sold.</li>
  <li><b>Shelf life: </b>The number of days between product production date and bast by date.</li>
  <li><b>Aging Status: </b>Label applied to inventory below a certain shelf life threshold e.g. 75% or 50%.</li>
  <li><b>Aging Extension: </b>When a product is sold past the normal shelf life threshold.</li>
  <li><b>FIFO: </b>First in, first out. </li>
</ul>

<h2>Data Structure: Page 2</h2>
<p>The dashboard required connecting to multiple sources in order to work. Sales Forecast, NSV by SKU, and production summaries were all web scraped from Google Sheets. In-house inventory data was provided from a 3PL data source. Shelf-life by SKU was pulled linked to a SharePoint file, and Fiscal Calendar data was generated manually within the sheet. First, the on-hand inventory and production schedule data was normalized and merged together to make a complete list of in-house and future production batches along with their production dates and shelf life. All other dates, or events, in the batch's lifecycle was calculated based on that production date. However, calculating the shipping cycle for a batch depended on also referencing the sales forecast and a fiscal calendar. </p>
<p>Once the dates of the lifecycle events were determined, I could calculate the difference between these dates to determine the time length of the different stages of a batch's lifecycle. Finally, this information would be filtered by SKU and prepared in a format suitable for a Gantt Chart. Since this is an interactive dashbaord, I created an additional space that incorporated the inital data and the dashboard interactions.</p>

<h2>Visualization of the Batch's Lifecycle: Pages 4-6</h2>
<p>The first example (page 4) shows what a batch looks like when it follows a normal lifecycle. It enters the warehouse and has an appropriate buffer of time before it needs to be shipped. Then it enters the shipping period. Once the production batch gets fully depleted, we have a space of time where we could have continued to ship it until it would have hit aging status. After that point we have the aging period where we might sell it through other channels until it hits its expiration date.</p>
<p>The second example (page 5) illustrates how surplus inventory is visualized. In this scenario, you can observe that the aging date and the fully shipped date have reversed positions. In this example the fully shipped date is the date the batch would fully deplete if we were to continue shipping. In these scenarios we can consider aging extensions.</p>
<p>The third example (page 6) illustrates a stock out scenario. In this example we have a period where the company is unable to fulfill shipments. Also, the landing date and shipping start date are compressed into a single event.</p>

<h2>Demonstrating how the Dashboard can be Used: pages 7-9</h2>
<p>First, an explanation of the different parts of the dashboard. Your eyes will likely be drawn to the Gantt Chart first. Each bar represents one of the in-house or future batches of inventory for a given SKU. These lots are organized in descending order by their production dates since we follow FIFO. You can follow the dark green sections to see which lot is projected to be sold at any given time. Above the chart is a table. Green represents the sections you can edit, blue represents useful information for the analysis, and gold represents the results. Finally, you can select the SKU and future production date range on the left-hand side of the table. </p>
<p>On page 7, we can see what the initial production plan was for a product. All of the in-house inventory was going to hit aging status, and an out-of-stock scenario was imminent. Finally, the future productions exceeded forecast, so we were expecture further aging towards the end of the year. So, we begin our anaylsis.</p>
<p>On page 8, imagine that we've decided to extend our aging rule from 60% to 45%. So we want to maximize aging extensions up to that point. You'll see some numbers are plugged into the aging extension column of the table. These represent the number of days we plan to extend each batch. Now, we have both surplus and extension quantities, and we can see the resulting NSV of our decision. NSV is our metric of choice since it very closely represents our increase in profit when we make an aging extension. Howeverm the aging extension has also eliminated the out-of-stock situation. This value is harder to quantify.</p>
<p>On page 9, we resolve the aging issue later in the year by pushing out the production date by about 3 months (91 days). You can see 91 plugged into the production date change column of the table. With this edit, we have improved our production and shipment plans as much as we could. We've increased profits by $25,668.71, we've reduced the total amount of surplus inventory by 60%, and we've eliminated an out-of-stock scenario!</p>

<h2>Showing how the Fully Shipped Date is calculated: Pages 10-14</h2>
<p>The fully shipped date was the most complex date to calculate, so I will demonstrate how I coded its calculation.</p>
<p>The first step (page 10) is identifying the quantity sold in the first month. I divide the remaining work days in the month by the total workdays in the month to get a percentage of the month is remaining. This is multiplied by the sales forecast to get the remaining sales for that SKU this month. Finally I take the miminum value between the total batch quantity and the remaining sales that month.</p>
<p>The second step (page 11) is identifying how many months the batch will be sold in. I did this by calculating a running sum of sales forecast until the forecast was greater than the batch quantity. The legnth of the running sum list identifies the number of months it will ship. Now (page 12) we can take the value of that running sum to give us the quantity shipped in the middle months. </p>
<p>The third step (page 13) is identifying the sales in the last month. First we check to see that the length of the months shipped is equal to 1. If it is, we return the value of the sales in the first month. Otherwise, we subtract the sales in the first and middle months from the initial batch quantity.</p>
<p>The final step (page 14) first identifies the start date of the final month by scanning through the fiscal calendar by the appropriate length if the months shipped is greater than 1. Otherwise, it can just reference the ship start date since the shipping period would only be in a single month in that scenario. Then it divides the sales in the last month identified in the previous step by the total forecasted sales for that month. This provides us with the ratio of the month this batch will cover us. We then multiply that by the total workdays for that month to get the number of days this batch will cover us. Finally, we add that number of workdays to the start date to get the fully shipped date.</p>
